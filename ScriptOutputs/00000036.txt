/* Write a Unity Editor script.
 - It provides its functionality as a menu item placed "Edit" > "Do Task".
 - It doesn’t provide any editor window. It immediately does the task when the menu item is invoked.
 - Don’t use GameObject.FindGameObjectsWithTag.
 - There is no selected object. Find game objects manually.
 - I only need the script body. Don’t add any explanation.
 - Don't forget to add "using UnityEditor;"
The task is described as follows:
make a particle system that sprays cubes of random colors in a cone */


using UnityEngine;
using UnityEditor;

public class ParticleSprayer : MonoBehaviour
{
    [MenuItem("Edit/Do Task")]
    static void DoTask()
    {
        GameObject particlePrefab = AssetDatabase.LoadAssetAtPath<GameObject>("Assets/Prefabs/Particle.prefab");
        
        Vector3 startPoint = new Vector3(0, 0, 0);
        float sprayAngle = 45f;
        float sprayForce = 10f;
        int cubeCount = 20;
        
        for(int i = 0; i < cubeCount; i++)
        {
            GameObject cube = GameObject.CreatePrimitive(PrimitiveType.Cube);
            cube.transform.position = startPoint;
            cube.transform.localScale = Vector3.one * Random.Range(0.5f, 2f);
            cube.GetComponent<Renderer>().material.color = new Color(Random.value, Random.value, Random.value);
            
            Vector3 sprayDirection = Quaternion.Euler(Random.Range(-sprayAngle, sprayAngle), Random.Range(-sprayAngle, sprayAngle), Random.Range(-sprayAngle, sprayAngle)) * Vector3.forward;
            cube.GetComponent<Rigidbody>().AddForce(sprayDirection * sprayForce, ForceMode.Impulse);
            
            GameObject particle = Instantiate(particlePrefab, startPoint, Quaternion.identity);
            particle.transform.LookAt(startPoint + sprayDirection);
        }
    }
}